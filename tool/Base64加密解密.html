<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿Base64ç¼–ç è§£ç  Â· å·¥å…·ç«™</title>
    <!-- jQuery (å¿…é¡») -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(145deg, #f2f5fc 0%, #e9eef4 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            padding: 20px;
            margin: 0;
        }

        .tool-container {
            max-width: 880px;
            width: 100%;
            background: rgba(255,255,255,0.75);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 32px;
            box-shadow: 0 20px 40px -10px rgba(0, 20, 50, 0.2), 0 4px 12px rgba(0,0,0,0.05);
            padding: 32px;
            border: 1px solid rgba(255,255,255,0.5);
        }

        /* æ ‡é¢˜åŒºç®€æ´ */
        .tool-title {
            font-size: 22px;
            font-weight: 600;
            color: #0b1e3a;
            margin-bottom: 20px;
            letter-spacing: -0.3px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .tool-title span {
            background: #1677ff;
            color: white;
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 30px;
            font-weight: 400;
        }

        /* è¾“å…¥åŒºåŸŸ */
        .input-section {
            margin-bottom: 24px;
        }
        .section-label {
            font-size: 14px;
            font-weight: 500;
            color: #1e2f4e;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-label .hint {
            color: #5f6c84;
            font-weight: 400;
            font-size: 13px;
        }
        textarea {
            width: 100%;
            height: 150px;
            padding: 16px 18px;
            background: #ffffff;
            border: 1.5px solid #d9e0eb;
            border-radius: 20px;
            font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            outline: none;
            transition: border 0.2s, box-shadow 0.2s;
            color: #17212d;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.02);
        }
        textarea:focus {
            border-color: #1677ff;
            box-shadow: 0 0 0 4px rgba(22,119,255,0.15);
        }

        /* æŒ‰é’®æ  */
        .action-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 28px;
            flex-wrap: wrap;
        }
        .btn-group {
            display: flex;
            gap: 8px;
            background: #f1f4f9;
            padding: 4px;
            border-radius: 40px;
        }
        .btn {
            border: none;
            padding: 8px 22px;
            border-radius: 30px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            background: white;
            border: 1px solid #d0d8e6;
            color: #1f2a44;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .btn.primary {
            background: #1677ff;
            border: 1px solid #1677ff;
            color: white;
            box-shadow: 0 6px 12px -6px rgba(22,119,255,0.4);
        }
        .btn.primary:hover {
            background: #0b5fd9;
            border-color: #0b5fd9;
            transform: translateY(-1px);
        }
        .btn.secondary:hover {
            background: #e5ecf5;
            border-color: #b7c2d6;
            transform: translateY(-1px);
        }
        .btn:active {
            transform: translateY(1px);
            box-shadow: none;
        }
        .shortcut-hint {
            margin-left: auto;
            font-size: 13px;
            background: #e5ebf3;
            padding: 6px 14px;
            border-radius: 30px;
            color: #2c3e5c;
            letter-spacing: 0.2px;
            border: 1px solid #cdd6e4;
        }

        /* è¾“å‡ºåŒºåŸŸ */
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .output-header-left {
            font-size: 15px;
            font-weight: 600;
            color: #0b1e3a;
        }
        .output-options {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .output-options label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #1f2e4a;
            cursor: pointer;
        }
        .copy-btn {
            background: white;
            border: 1px solid #cbd3e2;
            border-radius: 24px;
            padding: 5px 16px;
            font-size: 13px;
            font-weight: 500;
            color: #1e2f4e;
            cursor: pointer;
            transition: all 0.15s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .copy-btn:hover {
            background: #e9f0fa;
            border-color: #1677ff;
            color: #1677ff;
        }
        .copy-btn.copied {
            background: #16a34a;
            border-color: #16a34a;
            color: white;
        }
        #outputText {
            background: #ffffff;
            border-color: #d9e0eb;
        }

        /* è¾…åŠ© */
        .separator {
            height: 1px;
            background: linear-gradient(to right, #d0dae8, transparent);
            margin: 16px 0 10px 0;
        }
        .footer-note {
            text-align: right;
            font-size: 12px;
            color: #6d7b99;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- å¤´éƒ¨æ ‡è¯†ï¼Œç®€çº¦ç§‘æŠ€æ„Ÿ -->
        <div class="tool-title">
            âš¡ Base64 ç¼–ç /è§£ç 
            <span>UTF-8 âœ“</span>
        </div>

        <!-- 1. è¾“å…¥åŒºåŸŸ -->
        <div class="input-section">
            <div class="section-label">
                <span>ğŸ“¥ è¯·è¾“å…¥è¦è¿›è¡Œ Base64 ç¼–ç æˆ–è§£ç çš„å­—ç¬¦</span>
                <span class="hint">æ”¯æŒæ¢è¡Œ Â· è‡ªåŠ¨å»ç©ºç™½(è§£ç )</span>
            </div>
            <textarea id="inputText" placeholder="ä¾‹å¦‚: Hello ä¸–ç•Œ æˆ– 5L2g5aW9  ..."></textarea>
        </div>

        <!-- 2. æ“ä½œæŒ‰é’®åŒº -->
        <div class="action-bar">
            <div class="btn-group">
                <button id="encodeBtn" class="btn primary" data-mode="encode">ç¼–ç  (Encode)</button>
                <button id="decodeBtn" class="btn secondary" data-mode="decode">è§£ç  (Decode)</button>
                <button id="swapBtn" class="btn secondary">â‡„ äº¤æ¢</button>
            </div>
            <div class="shortcut-hint">
                âŒ˜ + Enter (ç¼–/è§£ç å¿«æ·é”®)
            </div>
        </div>

        <!-- 3. è¾“å‡ºåŒºåŸŸ -->
        <div class="output-header">
            <div class="output-header-left">
                ğŸ“‹ Base64 ç¼–ç æˆ–è§£ç çš„ç»“æœ:
            </div>
            <div class="output-options">
                <label>
                    <input type="checkbox" id="autoSelectCheckbox"> ç¼–ç åè‡ªåŠ¨å…¨é€‰
                </label>
                <button id="copyOutputBtn" class="copy-btn" title="å¤åˆ¶åˆ°å‰ªè´´æ¿">ğŸ“‹ å¤åˆ¶</button>
            </div>
        </div>
        <textarea id="outputText" placeholder="è¿™é‡Œå°†æ˜¾ç¤ºç»“æœ..." readonly></textarea>
        
        <!-- å¾®å°åˆ†éš” + æç¤º (æ— å®é™…åŠŸèƒ½ï¼Œåªä¸ºç¾è§‚) -->
        <div class="separator"></div>
        <div class="footer-note">
            Ctrl + Enter è§¦å‘å½“å‰æ¨¡å¼ (å½“å‰: <span id="currentModeHint">ç¼–ç </span>)
        </div>
    </div>

    <script>
        (function() {
            // ç¡®ä¿ jQuery å·²åŠ è½½ï¼Œä½†ä½¿ç”¨ $ å®‰å…¨
            $(document).ready(function() {

                // --- DOM å…ƒç´  ---
                const $input = $('#inputText');
                const $output = $('#outputText');
                const $encodeBtn = $('#encodeBtn');
                const $decodeBtn = $('#decodeBtn');
                const $swapBtn = $('#swapBtn');
                const $copyBtn = $('#copyOutputBtn');
                const $autoCheck = $('#autoSelectCheckbox');
                const $modeHint = $('#currentModeHint');

                // --- çŠ¶æ€å˜é‡ ---
                let currentMode = 'encode';   // 'encode' æˆ– 'decode'

                // --- å·¥å…·å‡½æ•°ï¼šBase64 ç¼–ç  (æ”¯æŒ Unicode) ---
                function base64Encode(str) {
                    try {
                        // ç»å…¸æ–¹æ³•: å…ˆ encodeURIComponent è½¬ä¹‰ï¼Œå†è½¬æˆäºŒè¿›åˆ¶ï¼Œbtoa
                        // æ³¨æ„: unescape å’Œ escape è™½å·²å¼ƒç”¨ä½†éå¸¸ç¨³å®šï¼Œå…¼å®¹æ€§å¥½
                        return btoa(unescape(encodeURIComponent(str)));
                    } catch (e) {
                        throw new Error('ç¼–ç å¤±è´¥ï¼šåŒ…å«æ— æ³•å¤„ç†çš„å­—ç¬¦');
                    }
                }

                // --- å·¥å…·å‡½æ•°ï¼šBase64 è§£ç  (æ”¯æŒ Unicodeï¼Œè‡ªåŠ¨å»é™¤ç©ºç™½) ---
                function base64Decode(base64Str) {
                    try {
                        // å»é™¤æ‰€æœ‰ç©ºç™½å­—ç¬¦ (ç©ºæ ¼ã€æ¢è¡Œã€åˆ¶è¡¨ç¬¦ç­‰) â€”â€” æå‡å®¹é”™
                        const cleaned = base64Str.replace(/\s+/g, '');
                        if (cleaned === '') return '';   // ç©ºå­—ç¬¦ä¸²è¿”å›ç©º
                        // atob è§£ç ï¼Œå†é€šè¿‡ decodeURIComponent + escape è¿˜åŸ Unicode
                        return decodeURIComponent(escape(atob(cleaned)));
                    } catch (e) {
                        throw new Error('æ— æ•ˆçš„ Base64 å­—ç¬¦ä¸² (æ— æ³•è§£æ)');
                    }
                }

                // --- æ›´æ–°æŒ‰é’®æ ·å¼ (æ ¹æ® currentMode) ---
                function updateButtonsStyle() {
                    if (currentMode === 'encode') {
                        $encodeBtn.removeClass('secondary').addClass('primary');
                        $decodeBtn.removeClass('primary').addClass('secondary');
                        $modeHint.text('ç¼–ç ');
                    } else {
                        $decodeBtn.removeClass('secondary').addClass('primary');
                        $encodeBtn.removeClass('primary').addClass('secondary');
                        $modeHint.text('è§£ç ');
                    }
                }

                // --- æ‰§è¡Œç¼–ç  (æ ¸å¿ƒ) ---
                function performEncode() {
                    const inputVal = $input.val();
                    try {
                        const encoded = base64Encode(inputVal);
                        $output.val(encoded);
                        
                        // è¾“å‡ºæ¡†è‡ªåŠ¨è·å¾—ç„¦ç‚¹
                        $output.focus();

                        // å¦‚æœå‹¾é€‰äº†â€œç¼–ç åè‡ªåŠ¨å…¨é€‰â€ï¼Œåˆ™å…¨é€‰è¾“å‡ºæ¡†å†…å®¹
                        if ($autoCheck.prop('checked')) {
                            $output.select();
                        }
                    } catch (e) {
                        $output.val('âŒ ç¼–ç é”™è¯¯: ' + e.message);
                        $output.focus();  // å‡ºé”™æ—¶ä¹Ÿèšç„¦ï¼Œæ–¹ä¾¿æŸ¥çœ‹
                    }
                }

                // --- æ‰§è¡Œè§£ç  (æ ¸å¿ƒ) ---
                function performDecode() {
                    const inputVal = $input.val();
                    try {
                        const decoded = base64Decode(inputVal);
                        $output.val(decoded);
                        $output.focus();   // è‡ªåŠ¨è·å¾—ç„¦ç‚¹
                        // æ³¨æ„ï¼šè§£ç æ°¸è¿œä¸è‡ªåŠ¨å…¨é€‰ (æ ¹æ®éœ€æ±‚ï¼Œåªæœ‰ç¼–ç åè‡ªåŠ¨å…¨é€‰)
                    } catch (e) {
                        $output.val('âŒ è§£ç å¤±è´¥: ' + e.message);
                        $output.focus();
                    }
                }

                // --- æ ¹æ®å½“å‰æ¨¡å¼æ‰§è¡Œæ“ä½œ ---
                function performCurrentMode() {
                    if (currentMode === 'encode') {
                        performEncode();
                    } else {
                        performDecode();
                    }
                }

                // --- äº‹ä»¶ç›‘å¬ ---

                // ç¼–ç æŒ‰é’®
                $encodeBtn.on('click', function() {
                    // æ”¹å˜å½“å‰æ¨¡å¼ä¸ºç¼–ç 
                    currentMode = 'encode';
                    updateButtonsStyle();
                    performEncode();   // ç«‹å³æ‰§è¡Œç¼–ç 
                });

                // è§£ç æŒ‰é’®
                $decodeBtn.on('click', function() {
                    currentMode = 'decode';
                    updateButtonsStyle();
                    performDecode();   // ç«‹å³æ‰§è¡Œè§£ç 
                });

                // äº¤æ¢æŒ‰é’®
                $swapBtn.on('click', function() {
                    const inputVal = $input.val();
                    const outputVal = $output.val();
                    $input.val(outputVal);
                    $output.val(inputVal);
                    // äº¤æ¢åï¼Œç„¦ç‚¹æ”¾åˆ°è¾“å…¥æ¡†æ–¹ä¾¿ç»§ç»­ç¼–è¾‘ (å¯é€‰)
                    $input.focus();
                    // æ³¨æ„ï¼šä¸æ”¹å˜ currentMode
                });

                // --- å…¨å±€å¿«æ·é”® Ctrl + Enter (æˆ–è€… Cmd + Enter å…¼å®¹Mac) ---
                $(document).on('keydown', function(e) {
                    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                        e.preventDefault();   // é˜»æ­¢é»˜è®¤çš„æ¢è¡Œ/æäº¤è¡Œä¸º
                        performCurrentMode();
                    }
                });

                // --- å¤åˆ¶æŒ‰é’® (å¸¦æç¤º) ---
                $copyBtn.on('click', function() {
                    const outputText = $output.val();
                    if (!outputText) {
                        // æ— å†…å®¹æ—¶æç¤ºä½†ä¸å˜æŒ‰é’®çŠ¶æ€
                        return;
                    }

                    // å°è¯•ä½¿ç”¨ Clipboard API (ç°ä»£æµè§ˆå™¨)
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(outputText).then(() => {
                            showCopySuccess();
                        }).catch(() => {
                            // fallback: ä½¿ç”¨ document.execCommand (æ—§æ–¹æ³•)
                            fallbackCopy(outputText);
                        });
                    } else {
                        fallbackCopy(outputText);
                    }

                    // å¤åˆ¶æˆåŠŸè§†è§‰åé¦ˆ
                    function showCopySuccess() {
                        const originalText = $copyBtn.text();
                        $copyBtn.text('âœ… å·²å¤åˆ¶!').addClass('copied');
                        setTimeout(() => {
                            $copyBtn.text(originalText).removeClass('copied');
                        }, 1200);
                    }

                    function fallbackCopy(text) {
                        try {
                            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„textarea ç”¨äºå¤åˆ¶
                            const $temp = $('<textarea>');
                            $('body').append($temp);
                            $temp.val(text).select();
                            const success = document.execCommand('copy');
                            $temp.remove();
                            if (success) {
                                showCopySuccess();
                            } else {
                                alert('æ— æ³•å¤åˆ¶ï¼Œè¯·æ‰‹åŠ¨é€‰ä¸­å Ctrl+C');
                            }
                        } catch (err) {
                            alert('å¤åˆ¶å¤±è´¥: ' + err);
                        }
                    }
                });

                // --- åˆå§‹åŒ–: é»˜è®¤ç¼–ç æ¨¡å¼, æŒ‰é’®æ ·å¼, å¹¶ç¡®ä¿è¾“å‡ºæ¡†åªè¯»ä½†å¯å¤åˆ¶ (å·²è®¾readonly) ---
                // å…¶å® output æˆ‘ä»¬è®¾ç½® readonly é˜²æ­¢è¯¯æ”¹ï¼Œä½†äº¤æ¢æ—¶ä»èƒ½å°†å€¼èµ‹ç»™å®ƒï¼Œä¸å½±å“ã€‚
                // å¦‚æœç”¨æˆ·å¸Œæœ›è¾“å‡ºæ¡†ä¹Ÿèƒ½æ‰‹åŠ¨ä¿®æ”¹ï¼Œå¯ä»¥å»æ‰ readonlyã€‚ä½†ä¸ºäº†ç¬¦åˆä¼ ç»Ÿå·¥å…·ä¹ æƒ¯ï¼Œä¿ç•™åªè¯»ã€‚
                // ä½†äº¤æ¢åŠŸèƒ½éœ€è¦å°†è¾“å‡ºæ¡†æ—§å€¼èµ‹ç»™è¾“å…¥æ¡†ï¼Œæ‰€ä»¥åªè¯»ä¸å½±å“èµ‹å€¼ã€‚
                // å·²è®¾ readonlyï¼ŒåŒæ—¶ä¸å½±å“å¤åˆ¶ã€‚

                // è®¾ç½®é»˜è®¤æ¨¡å¼
                currentMode = 'encode';
                updateButtonsStyle();

                // åŠ ä¸€ä¸ªç„¦ç‚¹å ä½: é»˜è®¤è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹
                $input.focus();

                // å°ç»†èŠ‚: å¦‚æœè§£ç é”™è¯¯ï¼Œè¾“å‡ºæ¡†æ˜¾ç¤ºé”™è¯¯ï¼Œç”¨æˆ·å¯ä»¥ç”¨äº¤æ¢å¿«é€Ÿä¿®æ­£å†…å®¹
                // æ‰€æœ‰åŠŸèƒ½æ»¡è¶³

                // é¢å¤–å¤„ç†ï¼šè§£ç æ—¶è‡ªåŠ¨å»é™¤ç©ºç™½å·²åœ¨ base64Decode ä¸­å®ç°

                // å¯é€‰: è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶ä¸æ¸…ç©ºç»“æœï¼Œå®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶
            });
        })();
    </script>
</body>
</html>